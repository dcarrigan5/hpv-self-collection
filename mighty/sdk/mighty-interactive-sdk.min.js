/**
 * Made with ❤️ by Mighty — Maestro LLC
 * Copyright © 2025 Maestro LLC
 */
var n=["MIGHTY_INTERACTIVE_LOADED","MIGHTY_INTERACTIVE_HEIGHT_REPORT","MIGHTY_INTERACTIVE_CSS_JS_REPORT","MIGHTY_INTERACTIVE_HTML_REPORT","MIGHTY_INTERACTIVE_READY","MIGHTY_INTERACTIVE_COMPLETE","MIGHTY_INTERACTIVE_GET_ZIP_FILE","MIGHTY_INTERACTIVE_SEND_ZIP_FILE","MIGHTY_INTERACTIVE_DYNAMIC_FORM_CONFIG","MIGHTY_INTERACTIVE_RELOAD_REQUESTED","MIGHTY_INTERACTIVE_SDK_HOST_PING","MIGHTY_INTERACTIVE_SDK_HOST_PONG","MIGHTY_INTERACTIVE_SDK_STATE_REQUESTED","MIGHTY_INTERACTIVE_SDK_STATE_PROVIDED"];function E(s){return typeof s=="object"&&s!==null&&typeof s.data=="object"&&s.data!==null&&n.includes(s.data.type)}var o=class{constructor(){this.messageHandlers=new Map,this.listenToPostMessagesRelatedToSDK()}onMessageReceived(e,t){return this.messageHandlers.has(e)||this.messageHandlers.set(e,new Set),this.messageHandlers.get(e)?.add(t),()=>{this.messageHandlers.get(e)?.delete(t)}}sendHostPingMessage(){this.postMessageToInteractiveBlockWindow({type:"MIGHTY_INTERACTIVE_SDK_HOST_PING"})}sendStateRequestedMessage(e){this.postMessageToInteractiveBlockWindow({type:"MIGHTY_INTERACTIVE_SDK_STATE_REQUESTED",data:{defaultState:e}})}sendMarkAsCompleteMessage(){this.postMessageToInteractiveBlockWindow({type:"MIGHTY_INTERACTIVE_COMPLETE"})}listenToPostMessagesRelatedToSDK(){window.addEventListener("message",e=>{if(E(e)){let t=e.data.type;switch(t){case"MIGHTY_INTERACTIVE_SDK_HOST_PONG":this.handleMessageReceived(t,e.data.data);break;case"MIGHTY_INTERACTIVE_SDK_STATE_PROVIDED":this.handleMessageReceived(t,e.data.data.state);break}}})}postMessageToInteractiveBlockWindow(e){window.parent!==window&&window.parent.postMessage(e,"*")}handleMessageReceived(e,t){let r=this.messageHandlers.get(e);r&&r.forEach(T=>{T(t??void 0)})}};var a=class{getState(e,t){return e}};var i=class{constructor(e){this.messenger=e}async getState(e){return new Promise((t,r)=>{let M=setTimeout(()=>{r(new Error("Interactive state not provided in time"))},5e3);this.messenger.onMessageReceived("MIGHTY_INTERACTIVE_SDK_STATE_PROVIDED",d=>{clearTimeout(M),t(d)}),this.messenger.sendStateRequestedMessage(e)})}};var I=class{constructor(){this.version="0.0.1";this.sdkIsReady=!1,this.messenger=new o,this.useNoOpMode=!1}async initialize(){await this.checkForHost()||(this.useNoOpMode=!0),this.useNoOpMode?this.state=new a:this.state=new i(this.messenger),this.sdkIsReady=!0,this.sdkReadyFn?.()}onSdkReady(e){this.sdkReadyFn=e,this.sdkIsReady&&e()}markAsComplete(){this.messenger.sendMarkAsCompleteMessage()}checkForHost(){return new Promise(e=>{this.messenger.onMessageReceived("MIGHTY_INTERACTIVE_SDK_HOST_PONG",t=>{t&&t.courseId&&t.blockId&&(this.courseId=t.courseId,this.blockId=t.blockId),e(!0)}),setTimeout(()=>{this.messenger.sendHostPingMessage(),setTimeout(()=>{e(!1)},100)},0)})}};var _=new I;window.mightyInteractiveSdk=_;_.initialize();
